---
// ============================================
// FLIPCARD COMPONENT
// ============================================
import type { FlipCardProps } from './FlipCard.types';
import { Picture } from 'astro:assets';

const {
  image,
  subtitle,
  description,
  imageAlt,
  aspectRatio = '4/3',
  flipDirection = 'horizontal',
  animationDuration = 600,
  overlayGradient = 'primary'
} = Astro.props as FlipCardProps;

// Generate classes
const containerClasses = [
  'flipcard',
  `flipcard--ratio-${aspectRatio.replace('/', '-')}`,
  flipDirection === 'vertical' && 'flipcard--vertical',
  animationDuration < 500 && 'flipcard--fast',
  animationDuration > 700 && 'flipcard--slow',
  `flipcard--${overlayGradient}`
].filter(Boolean).join(' ');
---

<div 
  class={containerClasses}
  data-flip-card
  role="button"
  tabindex="0"
  aria-label={`Voir plus sur ${subtitle}`}
>
  <div class="flipcard__inner">
    <!-- Front Side -->
    <div class="flipcard__front">
      <Picture
        src={image}
        alt={imageAlt || subtitle}
        class:list={['flipcard__image']}
        formats={['avif', 'webp']}
        loading="lazy"
        widths={[400, 600, 800]}
        sizes="(max-width: 768px) 100dvw, 400px"
      />
      <div class="flipcard__overlay" aria-hidden="true"></div>
    </div>
    
    <!-- Back Side -->
    <div class="flipcard__back">
      <div class="flipcard__content">
        <p class="flipcard__description">{description}</p>
      </div>
    </div>
  </div>
</div>

<style lang="scss">
  @use './FlipCard.styles.scss';
</style>

<script>
  import { initFlipCards } from './FlipCard.script';
  initFlipCards();
</script>